---
title: Linux系统磁盘分区与文件系统
categories:
  - 工作
tags:
  - Linux
  - 存储
  - 文件系统
  - 云计算
date: 2020-02-01 09:18:52
---

磁盘，即Disk，可反复擦写的计算机外部存储器设备，是计算机的信息载体。目前一般为硬盘，分为固态硬盘机械硬盘HDD和固态硬盘SSD两种，HDD以磁性碟片存储信息，SSD则是闪存颗粒。此外，还有一种混合硬盘，即HHD，也就是磁性硬盘和闪存的集成

# 1.硬盘接口类型

硬盘接口是硬盘与主机系统间的连接部件，作用是在硬盘缓存和主机内存之间传输数据。不同的硬盘接口决定了硬盘与计算机之间的连接速度，在整个系统中硬盘接口的优劣直接影响着程序运行快慢和系统性能好坏，主要分为IDE、SATA、SCSI、光纤通道和SAS

## 1.IDE

IDE，Integrated Drive Electronics，即电子集成驱动器，也就是将硬盘控制器与盘体集成的硬盘驱动器，以缩减硬盘接口的电缆数目与长度，使得制造更轻易，不必再考虑与其他厂商控制器的兼容性，且保障了数据传输的可靠性。目前已被淘汰

# 2.SATA

SATA，Serial ATA，又被称为串口硬盘，是PC机硬盘的主流趋势。2001年，由Intel、APT、Dell、IBM、希捷、迈拓几大厂商组成的Serial ATA委员会正式确立了Serial ATA 1.0规范。Serial ATA采用串行连接方式，串行ATA总线使用嵌入式时钟信号，具备更强的纠错能力，可对传输指令与数据进行检查，发现错误将会自动矫正，大大提高了数据传输的可靠性

# 3.SCSI

SCSI，Small Computer System Interface，即小型计算机系统接口，是同IDE（ATA）完全不同的接口，广泛应用于小型机上的高速数据传输技术。SCSI接口具有应用范围广、多任务、带宽大、CPU占用率低及热插拔等优点，但较高的价格使得它很难如IDE硬盘般普及，因此主要应用于中高端服务器和高档工作站中

# 4.光纤通道

光纤通道，即Fibre Channel，起初专为网络系统设计，但随着存储系统对速度的需求，逐渐应用到硬盘系统。光纤通道的主要特性有：热插拔性、高速带宽、远程连接、连接设备数量大等，适用于服务器这样的多硬盘系统环境，能满足高端工作站、服务器、海量存储子网络、外设间通过集线器、交换机和点对点连接进行双向、串行数据通讯等对高数据传输率的要求

# 5.5SAS

SAS，Serial Attached SCSI，即串行连接SCSI，新一代的SCSI技术，兼容SATA硬盘

# 2.硬盘分区

硬盘分区，即Disk partition，是将硬盘的整体存储空间划分成多个独立的逻辑区域，分别用于安装操作系统、应用程序及存储数据文件等，使得数据存放和管理更为方便与快捷。分区的规划非常必要，如一块硬盘划分为几个分区，每个分区多大容量，以及每个分区准备使用什么文件系统等。对于某些操作系统而言，硬盘必须分区后才能使用，否则不能被识别

## 2.1 分区类型

### 2.1.1 非DOS分区

非DOS分区，即Non-DOS Partition，一种特殊的分区形式，是将硬盘中的一块区域单独划分出来供另一个操作系统使用，对主分区的操作系统来讲是被划分出去的存储空间，且只有非DOS分区的操作系统才能管理和使用这块存储区域

### 2.1.2 主分区

主分区通常位于硬盘最前面的区域，用于存储主引导程序，负责检测硬盘分区的正确性及确定活动分区，并将引导权移交给活动分区的操作系统。主分区损坏将无法从硬盘引导系统，可从软驱或光驱引导之后再对硬盘读写

### 2.1.3 扩展分区 

扩展分区，严格地讲并不是一个实际意义的分区，仅仅是一个指向下一个分区的指针，从而将形成一个标明分区起始位置的单向链表。这样，在主引导扇区中除了主分区外，就逐个类推找到所有的分区。无论系统中建立多少个逻辑磁盘，在主引导扇区中通过一个扩展分区的参数就可以逐个找到每一个逻辑磁盘。扩展分区不能直接用，实际上是以若干逻辑分区作为单独的分区使用，也即所有逻辑分区都属于扩展分区的一部分

## 2.2 文件系统

文件系统，file system，即存储系统组织文件的方式，随磁盘分区格式化而建立。文件系统负责管理和存储文件信息，属于操作系统软件，是操作系统用于明确磁盘或分区文件的方法和数据结构，常见的文件系统如下：

### 2.2.1 FAT16/FAT32

早期MS-DOS和Windows操作系统常见的磁盘分区格式，采用16/32位文件分配表，磁盘利用效率低，运行速度慢

### 2.2.2 NTFS

优点是安全性和稳定性极其出色，使用中不易产生文件碎片，且能对用户的操作进行记录，权限管理严格，使每个用户只能按照系统赋予的权限进行操作，充分保护了系统与数据的安全，常见于Windows NT、Windows 2000/Vista/7/8/10等

### 2.2.3 EXT2/EXT3/EXT4

EXT，Linux extended file system，即Linux扩展文件系统，是Linux操作系统的磁盘格式，使用索引节点记录文件信息，类似于Windows文件分配表。索引节点包含文件长度、创建及修改时间、权限、数据区块等信息，由文件系统维护成为数组，每个文件或目录都与索引节点数组中的唯一一个元素对应，并分配了一个索引节点号。Linux文件系统将文件索引节点号和文件名同时保存在目录，也即是说目录是将文件名及其索引节点号结合的一张表，目录中每一对文件名和索引节点号称为一个连接。一个文件对应一个索引节点号，一个索引节点号可有多个文件名与之对应。因此，在磁盘上的同一个文件可以通过不同的路径去访问

EXT2是Linux早期的文件系统，EXT3支持日志文件系统，EXT4是EXT3的升级版，支持更大的文件系统和更高的性能

### 2.2.4 XFS

XFS是由SGI公司设计的被称为业界最先进最具可升级性的高性能文件系统，可以支持大容量的数据存储，并具有良好的IO性能，扩展性优于EXT4。Centos默认的文件系统即为XFS

## 2.3 挂载点

挂载点，即Linux系统将文件系统（磁盘分区、磁盘或网络共享等）连接到本地的目录，用于文件的访问和操作，从而将不同的文件系统整合为一个统一的文件结构。建议将不同的硬盘分区、外部存储设备、网络共享等挂载到不同的挂载点，以实现数据的组织和管理

# 3.目录结构

Linux操作系统所有的文件和目录被组织成以一个根节点开始的倒置的树状结构，文件系统的最顶层由根目录开始，使用/来表示根目录，根目录之下既可以是目录也可以是文件，每一个目录又可以包含子目录文件，如此反复

## 3.1 /bin

bin，Binaries，即二进制文件，用于存储经常使用的命令

## 3.2 /boot

引导分区，用于存储Linux系统启动时的核心文件，包括一些连接文件及镜像文件

## 3.3 /dev

dev，Device，即设备，Linux外部设备的挂载点，访问方式和文件一致

## 3.4 /etc

etc，Etcetera，用于存储系统管理所需要的配置文件和子目录

## 3.5 /home

用户家目录的挂载点，Linux系统每个用户都有自己的主目录，一般以用户账号命名，如alice、bob和eve

## 3.6 /lib

lib，Library，即库，用于存储Linux系统最基本的动态连接共享库，作用类似于Windows的DLL文件，几乎所有应用程序都要用到这些共享库

## 3.7 /lost+found

一般情况下为空，用于存储系统非法关机后生成的文件

## 3.8 /media

通常用于临时挂载设备，如USB驱动器、光盘等

## 3.9 /mnt

用于临时挂载文件系统，如光驱等

## 3.10 /opt

opt，optional，即可选，用于额外安装软件的目录，如Oracle数据库安装目录

## 3.11 /proc

proc，Processes，即进程，伪文件系统，是一个虚拟目录，也称虚拟文件系统，用于存储当前内核运行状态的一系列特殊文件，是系统内存的映射，也即是说这个目录的信息不实存储于硬盘而是内存，可以直接访问这个目录以获取系统信息，也可以直接修改某些文件，如屏蔽主机的ping命令而主机无法被ping：

    echo 1 > /proc/sys/net/ipv4/icmp_echo_ignore_all

## 3.12 /root

该目录为系统管理员，也称作超级管理员的主目录

## 3.13 /sbin

Super User Binaries，即超级用户的二进制文件，存储系统管理员使用的系统管理程序

## 3.14 /selinux

Redhat/CentOS特有目录，用于存储Selinux安全机制的相关文件，类似于Windows防火墙，但这套机制比较复杂，不易操控，一般都建议关闭

## 3.15 /srv

用于存储一些服务启动之后需要提取的数据

## 3.16 /sys

sysfs文件系统的挂载点，用于存储内核对象所对应的文件和目录，是内核设备树的直观反映，集成于Linux2.6内核，包含三种文件系统的信息：针对进程信息的 proc文件系统、针对设备的devfs文件系统及针对伪终端的devpts文件系统

## 3.17 /tmp

tmp，temporary，即临时的，用于存放临时文件，对于一个大型多用户的系统或者网络服务器，建议创建单独的分区

## 3.18 /usr

 usr，unix shared resources，即共享资源，用于存储应用程序和文件，类似于Windows的program files目录

 ## 3.19 /usr/bin

用于存储系统用户所使用的应用程序

## 3.20 /usr/sbin

用于存储超级用户所使用的比较高级的管理程序和系统守护程序

## 3.21 /usr/src

用于存储Linux系统内核源程序和RPM/DEB包的源程序，以及内核所有源程序与新版本内核（主机可能有保存几个不同版本内核的需求）

## 3.22 /var

var，variable，即变量，用于存储持续扩充的文件，如日志文件，一般写入/var/log，打印队列文件通常写入/var/spool

## 3.23 /run

用于存储系统启动之后的信息，临时文件系统，系统重启将被清空，建议将/var/run目录指向/run

## 3.24 swap

交换分区，用于创建虚拟内存，物理内存不足时数据将被写入

# 4.分区方案

## 4.1 普通分区

- swap，建议为物理内存小于8G时设为物理内存的2倍，小于64G设为物理内存的1.5倍，大于64G设为大于4G

- /boot，设为1G

- /(root)，剩余所有空间

## 4.2 数据库服务器

普通分区方案之外，创建数据挂载点用于挂载额外的磁盘，并将数据库的数据目录映射到该挂载点，如MySQL数据库数据文件目录设为/var/lib/mysql，以便于升级或重装系统之后数据库的数据无需再进行恢复

## 4.3 文件服务器

普通分区方案之外，创建独立的分区用于文件的存储

## 4.4 网站服务器

普通分区之外，创建独立的分区用于存储网站目录，如/var/www